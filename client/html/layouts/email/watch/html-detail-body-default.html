<?php

/**
 * @copyright Copyright (c) Metaways Infosystems GmbH, 2014
 * @license LGPLv3, http://www.arcavias.com/en/license
 */

$enc = $this->encoder();

$detailTarget = $this->config( 'client/html/catalog/detail/url/target' );
$detailController = $this->config( 'client/html/catalog/detail/url/controller', 'catalog' );
$detailAction = $this->config( 'client/html/catalog/detail/url/action', 'detail' );
$detailConfig = $this->config( 'client/html/catalog/detail/url/config', array( 'absoluteUri' => 1 ) );

?>
<style type="text/css">
/* From arcavias.css */
.arcavias li.attr-item,
.arcavias li.form-item {
	list-style: none;
	padding: 0;
	margin: 0;
}

.arcavias .header {
	border-radius: 0.5em;
	-moz-border-radius: 0.5em;
	-webkit-border-radius: 0.5em;
}

.arcavias .container {
	border-radius: 5px;
	-moz-border-radius: 5px;
	-webkit-border-radius: 5px;
	border: solid 1px #689DB9;
	margin: 10px 0px;
	padding: 0px 5px;
	min-width: 240px;
	max-width: 100%;
}


/* Common summary */
.common-summary .content {
	margin: 10px;
}

.common-summary .header,
.common-summary-detail .header {
	background-color: #F2F7FA;
	padding: 5px 10px;
	margin: 5px;
	margin-top: 0;
}

.common-summary-detail h2 {
	display: inline-block;
	font-size: 1em;
}

.common-summary-detail .header {
	border-bottom: none;
	background-color: #FFFFFF;
}

.common-summary-detail .product {
	margin: 0px 5px;
}

.common-summary-detail .details img {
	float: left;
	max-width: 60px;
	max-height: 80px;
	overflow: hidden;
	margin-right: 1em;
}

.common-summary-detail .details .product-name {
	font-weight: bold;
	font-size: 133%;
	margin: 0.5em;
	display: block;
}
</style>
<div class="common-summary-detail common-summary content-block container">
	<div class="header">
		<h2><?php echo $enc->html( $this->translate( 'client/html', 'Details' ), $enc::TRUST ); ?></h2>
	</div>
<?php foreach( $this->extProducts as $id => $product ) : ?>
	<div class="product">
<?php	$media = $product->getRefItems( 'media', 'default', 'default' ); ?>
<?php	if( ( $image = reset( $media ) ) !== false && ( $url = $image->getUrl() ) != '' ) : ?>
		<img src="<?php echo $this->content( $url ); ?>" />
<?php	endif; ?>
<?php	$params = array( 'd-product-id' => $id, 'a-name' => str_replace( ' ', '-', strip_tags( $product->getName() ) ) ); ?>
		<a class="product-name" href="<?php echo $enc->attr( $this->url( $detailTarget, $detailController, $detailAction, $params, array(), $detailConfig ) ); ?>">
<?php	echo $enc->html( $product->getName(), $enc::TRUST ); ?>
		</a>
		<div class="price-list">
<?php	echo $this->price( $product->getRefItems( 'price', 'default', 'default' ) ); ?>
		</div>
<?php endforeach; ?>
<?php echo $this->get( 'detailBody' ); ?>
</div>
