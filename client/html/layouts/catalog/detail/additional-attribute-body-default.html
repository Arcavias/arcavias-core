<?php

/**
 * @copyright Copyright (c) Metaways Infosystems GmbH, 2014
 * @license LGPLv3, http://www.arcavias.com/en/license
 */

if( isset( $this->detailProductItem ) ) {
	$items = $this->detailProductItem->getRefItems( 'attribute', null, 'default' );
} else {
	$items = array();
}

$attrItems = $this->get( 'detailProductAttributeItems', array() );
$contentUrl = $this->config( 'client/html/common/content/baseurl' ) . '/';
$enc = $this->encoder();

?>
<?php if( count( $items ) > 0 ) : ?>
<h2 class="header attributes"><?php echo $enc->html( $this->translate( 'client/html', 'Characteristics' ), $enc::TRUST ); ?></h2>
<table class="content attributes">
	<tbody>
<?php foreach( $items as $id => $item ) : ?>
<?php	if( isset( $attrItems[$id] ) ) { $item = $attrItems[$id]; } ?>
		<tr class="item">
			<td class="name"><?php echo $enc->html( $this->translate( 'client/html', $item->getType() ), $enc::TRUST ); ?></td>
			<td class="value">
				<div class="attr-images">
<?php		foreach( $item->getListItems( 'media', 'default' ) as $listItem ) : ?>
<?php			if( ( $mediaItem = $listItem->getRefItem() ) !== null ) : ?>
					<img class="attr-image" src="<?php echo $enc->attr( $contentUrl . $mediaItem->getUrl() ); ?>" alt="<?php echo $enc->attr( $mediaItem->getName() ); ?>" />
<?php			endif; ?>
<?php		endforeach; ?>
				</div>
				<span class="attr-name"><?php echo $enc->html( $item->getName() ); ?></span>
			</td>
		</tr>
<?php endforeach; ?>
	</tbody>
</table>
<?php endif; ?>
<?php echo $this->get( 'attributeBody' ); ?>
